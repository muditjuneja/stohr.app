---
layout: layout.njk
---


<div class="flex justify-center items-center h-screen bg-gray-100">
  <div class="w-full max-w-lg bg-white rounded-lg shadow-lg p-8">
    <h2 class="text-lg font-semibold text-gray-900 mb-4">Send us your query</h2>
    <!-- <p class="text-sm text-gray-600 mb-6">Use a permanent address where you can receive mail.</p> -->

    <form id="checkout-form">
      <!-- <div id="error-messages" class="text-red-500 mb-4"></div> -->
      <div id="error-messages" class="hidden mt-4">
        <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert">
          <strong class="font-bold">Please correct the following errors:</strong>
          <span class="block sm:inline"></span>
          <ul id="error-list" class="list-disc list-inside"></ul>
        </div>
      </div>
      <div class="grid grid-cols-1 gap-y-4 sm:grid-cols-2 gap-x-4">
        <div class="mb-4">
          <label for="first-name" class="block text-sm font-medium text-gray-700">First Name <span
              class="text-red-500">*</span></label>
          <input type="text" name="first-name" id="first-name" autocomplete="given-name"
            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
        </div>
        <div class="mb-4">
          <label for="last-name" class="block text-sm font-medium text-gray-700">Last Name <span
              class="text-red-500">*</span></label>
          <input type="text" name="last-name" id="last-name" autocomplete="family-name"
            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
        </div>
        <div class="mb-4">
          <label for="email" class="block text-sm font-medium text-gray-700">Email Address <span
              class="text-red-500">*</span></label>
          <input type="email" name="email" id="email" autocomplete="email"
            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
        </div>
        <div class="mb-4">
          <label for="phone" class="block text-sm font-medium text-gray-700">Phone Number <span
              class="text-red-500">*</span></label>
          <input type="tel" name="phone" id="phone" autocomplete="mobile"
            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
        </div>
        <div class="mb-4">
          <label for="country" class="block text-sm font-medium text-gray-700">Country</label>
          <select id="country" name="country" autocomplete="country-name"
            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
            <option>United States</option>
            <option>Canada</option>
            <option>Mexico</option>
          </select>
        </div>
        <div class="mb-4">
          <label for="region" class="block text-sm font-medium text-gray-700">State / Province</label>
          <input type="text" name="region" id="region" autocomplete="address-level1"
            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
        </div>
        <div class="mb-4">
          <label for="city" class="block text-sm font-medium text-gray-700">City</label>
          <input type="text" name="city" id="city" autocomplete="address-level2"
            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
        </div>
        <div class="mb-4">
          <label for="postal-code" class="block text-sm font-medium text-gray-700">ZIP / Postal Code</label>
          <input type="text" name="postal-code" id="postal-code" autocomplete="postal-code"
            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
        </div>
        <div class="mb-4 col-span-full">
          <label for="street-address" class="block text-sm font-medium text-gray-700">Address</label>
          <input type="text" name="street-address" id="street-address" autocomplete="street-address"
            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
        </div>
        <div class="mb-4 col-span-full">
          <label for="query" class="block text-sm font-medium text-gray-700">Your Query</label>
          <textarea id="query" name="query" rows="3"
            class="mt-1 p-2 block w-full border border-gray-300 rounded-md"></textarea>
        </div>
      </div>



      <div class="mt-6 flex items-center justify-end">
        <button type="button" class="text-sm text-gray-600 hover:text-gray-900">Cancel</button>
        <button type="submit"
          class="ml-3 inline-flex items-center px-4 py-2 bg-indigo-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
          <span>Submit</span>
          <svg id="submit-spinner" class="animate-spin -mr-1 ml-2 h-4 w-4 text-white hidden"
            xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor"
              d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 4.418 3.582 8 8 8v-4zm16-2.291A7.962 7.962 0 0120 12h4c0 4.418-3.582 8-8 8v-4z">
            </path>
          </svg>
        </button>
      </div>

      <!-- <div id="loading-message" class="text-blue-500 hidden mt-4">Submitting...</div> -->
      <div id="success-message" class="text-green-500 hidden mt-4 flex justify-center">Submitted successfully!</div>
    </form>
  </div>
</div>



<script>
  document.getElementById('checkout-form').addEventListener('submit', function (event) {
    event.preventDefault();

    var formData = new FormData(event.target);

    let object = {};
    formData.forEach((value, key) => object[key] = value);

    // Validation
    let errors = [];

    // Validate first name and last name
    if (!object['first-name'] || !object['last-name']) {
      errors.push('Please enter your first and last name.');
    }

    // Validate email
    let emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailRegex.test(object['email'])) {
      errors.push('Please enter a valid email address.');
    }

    // Validate phone
    let phoneRegex = /^\+?(\d[\d-. ]+)?(\([\d-. ]+\))?[\d-. ]+\d$/;
    if (!phoneRegex.test(object['phone'])) {
      errors.push('Please enter a valid phone number. You can use spaces, hyphens, and dots as separators.');
    }

    if (errors.length > 0) {
      let errorList = document.getElementById('error-list');
      errorList.innerHTML = '';
      errors.forEach(error => {
        let listItem = document.createElement('li');
        listItem.textContent = error;
        errorList.appendChild(listItem);
      });
      document.getElementById('error-messages').classList.remove('hidden');
      return;
    }

    let json = JSON.stringify(object);
    console.log(json);

    document.getElementById('submit-spinner').classList.remove('hidden');

    fetch('{{core.backend}}/{{core.formEndpoint}}', {
      method: 'POST',
      body: json,
      headers: {
        'Content-Type': 'application/json'
      }
    })
      .then(response => response.json())
      .then(data => {
        console.log(data)
        // Hide the loading message and show the success message
        document.getElementById('success-message').classList.remove('hidden');
      })
      .catch((error) => {
        console.error('Error:', error);

      }).finally(() => {
        document.getElementById('submit-spinner').classList.add('hidden');
      });
  });
</script>